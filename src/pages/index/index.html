<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; 
    script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; 
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; 
    font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com; 
    connect-src *; img-src * data:; frame-src *; object-src 'none';">
    <title>SpaceApp</title>

    <link rel="stylesheet" href="./style.css">
 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>
    <div id="app">
        <div id="sidebar">
            <div class="nav-section">
                <button class="nav-button" data-nav="home" title="Home">
                    <img src="../../assets/home.png" alt="Home">
                </button>
                <button class="nav-button" data-nav="whatsapp" title="WhatsApp">
                    <img src="../../assets/whatsapp.png" alt="WhatsApp">
                </button>
                <button class="nav-button" data-nav="telegram" title="Telegram">
                    <img src="../../assets/telegram.png" alt="Telegram">
                </button>
                <button class="nav-button" data-nav="gmail" title="Gmail">
                    <img src="../../assets/gmail.png" alt="Gmail">
                </button>
                <button class="nav-button" data-nav="outlook" title="Outlook">
                    <img src="../../assets/outlook.png" alt="Outlook">
                </button>
                <button class="nav-button" data-nav="linkedin" title="LinkedIn">
                    <img src="../../assets/linkedin.png" alt="LinkedIn">
                </button>
                <button class="nav-button" data-nav="messenger" title="Messenger">
                    <img src="../../assets/messenger.png" alt="Messenger">
                </button>
                <button class="nav-button" data-nav="wechat" title="WeChat">
                    <img src="../../assets/wechat.png" alt="WeChat">
                </button>
                <button class="nav-button" data-nav="snapchat" title="Snapchat">
                    <img src="../../assets/snapchat.png" alt="Snapchat">
                </button>
                <button class="nav-button" data-nav="line" title="Line">
                    <img src="../../assets/line.png" alt="Line">
                </button>
                <button class="nav-button" data-nav="discord" title="Discord">
                    <img src="../../assets/discord.png" alt="Discord">
                </button>
                <button class="nav-button" data-nav="skype" title="Skype">
                    <img src="../../assets/skype.png" alt="Skype">
                </button>
                <button class="nav-button" data-nav="slack" title="Slack">
                    <img src="../../assets/slack.png" alt="Slack">
                </button>
                <button class="nav-button" data-nav="viber" title="Viber">
                    <img src="../../assets/viber.png" alt="Viber">
                </button>
                <button class="nav-button" data-nav="kik" title="Kik">
                    <img src="../../assets/kik.png" alt="Kik">
                </button>
                <button class="nav-button" data-nav="hangouts" title="Hangouts">
                    <img src="../../assets/hangouts.png" alt="Hangouts">
                </button>
                <button class="nav-button" data-nav="microsoftTeams" title="Microsoft Teams">
                        <img src="../../assets/teams.png" alt="Microsoft Teams">
                </button>
                <button class="nav-button" data-nav="chatgpt" title="ChatGPT">
                    <img src="../../assets/chatgpt.png" alt="ChatGPT">
                </button>
            </div>
        </div>

        <div id="content">
            <div id="header">
                <button id="notifications-button" aria-label="Notificações">
                    <i class="fas fa-bell"></i>
                    <span>Notificações</span>
                </button>
                <button id="logout-button" aria-label="Sair">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Sair</span>
                </button>
            </div>
            <div id="content-container">
                <webview id="webview" allowpopups="true"
                webpreferences="contextIsolation=false, nodeIntegration=false, nativeWindowOpen=false"
                partition="persist:mainSession" partition="persist:gmail" useragent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"></webview>
            </webview>
            <webview id="preloader" style="display: none; width: 0; height: 0;" partition="persist:preloader">
            </webview>
            </div>
        </div>
    </div>
    <div id="notifications-panel" class="hidden">
        <span class="close-btn" onclick="toggleNotifications()"></span>
        <div class="notification">
            <strong>João:</strong> Enviou uma mensagem para você.
        </div>
        <div class="notification">
            <strong>Ana:</strong> Curtiu sua postagem.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
        <div class="notification">
            <strong>Pedro:</strong> Comentou no seu post.
        </div>
    </div>

    <script src="../renderer.js"></script>
    <script>
        // Script para o botão de logout
        document.getElementById('logout-button').addEventListener('click', () => {
            // Enviar evento de logout para o processo principal
            if (typeof require !== 'undefined') {
                const { ipcRenderer } = require('electron');
                ipcRenderer.send('logout-success');
            }
        });
        document.getElementById('notifications-button').addEventListener('click', () => {
            // Enviar evento de logout para o processo principal
            if (typeof require !== 'undefined') {
                const { ipcRenderer } = require('electron');
                ipcRenderer.send('notifications-center');
            }
        });

        function toggleNotifications() {
            let panel = document.getElementById('notifications-panel');
            let button = document.getElementById('notifications-button');
            let rect = button.getBoundingClientRect();

            // Ajustando a posição para garantir que fique abaixo do botão
            panel.style.top = `${rect.bottom + 5}px`; // Adiciona um pequeno espaço abaixo do botão
            panel.style.left = `${rect.left}px`; // Mantém alinhado com o botão

            // Alterna a visibilidade do painel
            panel.style.display = (panel.style.display === 'block') ? 'none' : 'block';
        }

        document.getElementById('notifications-button').addEventListener('click', function (event) {
            event.stopPropagation();
            toggleNotifications();
        });

        document.addEventListener('click', function (event) {
            let panel = document.getElementById('notifications-panel');
            let button = document.getElementById('notifications-button');

            if (!button.contains(event.target) && !panel.contains(event.target)) {
                panel.style.display = 'none';
            }
        });

        // Script para atualizar o título da página e ativar o botão de navegação
        const navButtons = document.querySelectorAll('.nav-button');
        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                navButtons.forEach(btn => btn.classList.remove('active'));
                // Add active class to clicked button
                button.classList.add('active');

                // Update page title
                const nav = button.getAttribute('data-nav');
                const pageTitle = document.getElementById('page-title');
                const titleText = nav.charAt(0).toUpperCase() + nav.slice(1);

                // Set icon based on nav
                let icon = 'compass';
                if (nav === 'whatsapp') icon = 'whatsapp';
                else if (nav === 'telegram') icon = 'paper-plane';
                else if (nav === 'gmail' || nav === 'outlook') icon = 'envelope';
                else if (nav === 'linkedin') icon = 'linkedin-in';
                else if (nav === 'discord') icon = 'discord';
                else if (nav === 'home') icon = 'home';

                pageTitle.innerHTML = `<i class="fab fa-${icon}"></i> ${titleText}`;
            });
        });
    </script>
</body>

</html>